<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>For My Valentine</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Great+Vibes&display=swap" rel="stylesheet">

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  height: 100svh;
  background: linear-gradient(135deg, #3a0f1f, #7a1f3d, #b23a5f);
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Playfair Display', serif;
  overflow: hidden;
}

/* Floating hearts */
.heart {
  position: fixed;
  bottom: -10px;
  color: rgba(255,255,255,0.8);
  pointer-events: none;
  animation: floatUp linear infinite;
  z-index: 0;
}

@keyframes floatUp {
  to {
    transform: translateY(-120vh) scale(1.2);
    opacity: 0;
  }
}

/* Envelope */
.envelope {
  width: 85vw;
  max-width: 360px;
  aspect-ratio: 16 / 10;
  position: relative;
  background: #fff0f5;
  border-radius: 10px;
  cursor: pointer;
  transform-style: preserve-3d;
  transition: all 0.9s cubic-bezier(.4,0,.2,1);
  box-shadow: 0 25px 50px rgba(0,0,0,0.45);
  z-index: 2;
}

.envelope.open {
  transform: scale(1.05);
}

.envelope.writing {
  transform: scale(0.8) translateY(60px);
  opacity: 0.4;
}

/* Flap */
.flap {
  position: absolute;
  inset: 0;
  background: #ffd6e3;
  clip-path: polygon(0 0, 100% 0, 50% 55%);
  transform-origin: top;
  transition: transform 0.8s cubic-bezier(.4,0,.2,1);
  z-index: 2;
}

.envelope.open .flap {
  transform: rotateX(-160deg);
}

/* Letter */
.letter {
  position: absolute;
  inset: 8px;
  background: #ffffff;
  padding: 18px 16px 60px;
  border-radius: 8px;
  opacity: 0;
  transform: translateY(30px) scale(0.96);
  transition: all 0.8s cubic-bezier(.4,0,.2,1);
  overflow-y: auto;
  z-index: 1;
}

.envelope.open .letter {
  opacity: 1;
  transform: translateY(0) scale(1);
}

.dialogue {
  text-align: center;
  margin-top: 60px;
  font-size: 0.95rem;
  opacity: 0;
  transition: opacity 1s ease;
}

.writing-text {
  font-family: 'Great Vibes', cursive;
  font-size: 1.1rem;
  line-height: 1.7;
  white-space: pre-wrap;
}

.love-line {
  opacity: 0;
  text-align: center;
  font-size: 1.1rem;
  margin-top: 18px;
  transition: opacity 2s ease, transform 2s ease;
  transform: scale(0.95);
}

.close {
  position: absolute;
  bottom: 10px;
  right: 12px;
  background: rgba(0,0,0,0.05);
  border: none;
  border-radius: 50%;
  width: 36px;
  height: 36px;
  font-size: 18px;
}

/* Fountain Pen (far away) */
.pen {
  position: fixed;
  left: 40px;
  bottom: 60px;
  width: 90px;
  cursor: pointer;
  z-index: 3;
  transition: transform 0.3s ease;
}

.pen:hover {
  transform: scale(1.1);
}

.hint {
  position: absolute;
  bottom: -40px;
  width: 100%;
  text-align: center;
  color: rgba(255,255,255,0.85);
  font-size: 0.85rem;
}
</style>
</head>

<body>

<audio id="bgMusic" loop>
  <source src="love-music.mp3" type="audio/mpeg">
</audio>

<div class="envelope" id="envelope">
  <div class="flap"></div>

  <div class="letter" onclick="event.stopPropagation()">
    <button class="close" onclick="closeLetter(event)">√ó</button>

    <div class="dialogue" id="dialogue">
      Oh no... I forgot to write in it.
      <br><br>
      Maybe I should find my pen...
    </div>

    <div class="writing-text" id="letterText"></div>

    <div class="love-line" id="finalLine">Forever my Valentine üíò</div>
  </div>

  <div class="hint">Tap gently ‚ù§Ô∏è</div>
</div>

<!-- Fountain Pen -->
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/Fountain_pen_nib_icon.svg/512px-Fountain_pen_nib_icon.svg.png"
class="pen" id="pen">

<script>
const envelope = document.getElementById('envelope');
const dialogue = document.getElementById('dialogue');
const pen = document.getElementById('pen');
const letterText = document.getElementById('letterText');
const finalLine = document.getElementById('finalLine');
const music = document.getElementById('bgMusic');

const text = `My love,

Loving you feels like discovering home in a person.
With you, I don‚Äôt have to rush, pretend, or hide ‚Äî
I simply exist, and that feels like peace.

You are my favorite thought at random hours,
the reason my smile appears without warning.

This Valentine‚Äôs Day isn‚Äôt about grand gestures.
It‚Äôs about choosing you ‚Äî in laughter, in silence,
and in everything in between.

If I could give you one thing,
it would be the ability to see yourself through my eyes ‚Äî
because then you‚Äôd know just how deeply loved you are.`;

/* Open envelope */
envelope.addEventListener('click', () => {
  if (!envelope.classList.contains('open')) {
    envelope.classList.add('open');
    setTimeout(() => {
      dialogue.style.opacity = "1";
    }, 600);
  }
});

/* Writing starts when pen clicked */
pen.addEventListener('click', () => {
  if (envelope.classList.contains('open')) {
    dialogue.style.opacity = "0";
    envelope.classList.add('writing');
    fadeInMusic();
    startWriting();
  }
});

/* Typewriter */
function startWriting() {
  let i = 0;
  function type() {
    if (i < text.length) {
      letterText.textContent += text.charAt(i);
      letterText.parentElement.scrollTop = letterText.parentElement.scrollHeight;
      i++;
      setTimeout(type, 35);
    } else {
      finalLine.style.opacity = "1";
    }
  }
  type();
}

/* Music fade-in */
function fadeInMusic() {
  music.volume = 0;
  music.play().catch(()=>{});
  let vol = 0;
  const fade = setInterval(() => {
    if (vol < 0.35) {
      vol += 0.02;
      music.volume = vol;
    } else {
      clearInterval(fade);
    }
  }, 120);
}

/* Close */
function closeLetter(e) {
  e.stopPropagation();
  envelope.classList.remove('open','writing');
  dialogue.style.opacity = "0";
  letterText.textContent = "";
  finalLine.style.opacity = "0";
  music.pause();
  music.currentTime = 0;
}

/* Floating hearts */
for (let i = 0; i < 30; i++) {
  const heart = document.createElement("div");
  heart.className = "heart";
  heart.innerHTML = "‚ù§";
  heart.style.left = Math.random() * 100 + "vw";
  heart.style.animationDuration = (6 + Math.random() * 6) + "s";
  heart.style.opacity = Math.random();
  heart.style.fontSize = (12 + Math.random() * 14) + "px";
  document.body.appendChild(heart);
}
</script>

</body>
</html>
